import{u as j,G as V,ao as q,j as P,V as M,c as e,ap as I,键 as O,a9 as n}from"./index.b078bf5f.js";import{u as D}from"./3ce44458.js";import{_ as H}from"./f60b2069.js";import{_ as L,a as G}from"./ff9abfe5.js";const Q=()=>{j();const A=V();return q({ref:A,onInit:v=>{e.keyboardState=e.createKeyboardState();const m=I(H).Keyboard_81_beat75_KeyMappings(v),S=I(L).Keyboard_81_beat75_RT_On(v),g=I(G).Keyboard_81_beat75_RT_Off(v);return m.root.appendChild(g.root),g.root.appendChild(S.root),D.addKeySelectionAndMappingEffects(m),D.addKeySelectionAndMappingEffects(g),D.addKeySelectionAndMappingEffects(S),{uiForRtOff:g,uiForRtOn:S,uiForKeyMappings:m}},onRefresh:({uiForRtOff:v,uiForRtOn:m,uiForKeyMappings:S})=>{const g=e.getCurrentDevice(),F=e.keyboardState.keys,f=m.status,p=v.status,a=S.status;D.updateKeyboard(S,t=>{const _=F[t];if(!_)return;const w=_.isHover,h=_.isSelected,b=e.getIs改键(t),o=e.getIs禁用(t),l=e.getIs高级键改键(t);if(e.current键盘设置页SubpageIndex===O.磁轴设置&&!l){S.status.default.id[t]&&Object.values(a).forEach(T=>{T.id[t].style.display="none"});return}const i=e.getCurrentDevice().磁轴.所有按键.find(u=>u.按键===t);i&&i.RT&&Object.values(a).forEach(T=>T.id[t].style.display="none");const c=u=>{if(!u)return;const T=u.querySelectorAll("path")[0];T&&(T.style.display="none");const R=u.querySelectorAll("text")[1];R&&(R.style.display="none")};Object.values(a).forEach(u=>u.id[t].style.display="none");const d=h&&w,y=h&&!w,x=!h&&w,E=!h&&!w;let r;const K=e.系统按键;if(e.isFnLayer&&K.has(t)){n.show(a.systemKey.id[t]),c(a.systemKey.id[t]);return}d?r=a.current_hover:y?r=a.current:x?b||l?r=a.changed:o?r=e.isFnLayer?a.hover:a.forbidden:r=a.hover:E&&(b||l?r=a.changed:o?e.isFnLayer?r=a.default:r=a.forbidden:r=a.default),r&&(n.show(r.id[t]),c(r.id[t]))}),D.updateKeyboard(v,t=>{const _=F[t];if(!_)return;if(e.current键盘设置页SubpageIndex!==O.磁轴设置){v.status.default.id[t]&&Object.values(p).forEach(c=>c.id[t].style.display="none");return}const h=e.getCurrentDevice().磁轴.所有按键.find(i=>i.按键===t);e.getIs改键(t),e.getIs禁用(t);const b=e.getIs高级键改键(t);if(e.getIsSwapKey(t),h){const{RT:i}=h;if(i||b){Object.values(p).forEach(c=>c.id[t].style.display="none");return}}let o=_.isHover,l=_.isSelected;l&&(e.当前选中按键_单键=t,e.当前选中按键_多键.includes(t)||e.当前选中按键_多键.push(t));const s=i=>{if(!i)return;const c=i.querySelectorAll("path")[0];c&&(c.style.display="none");const d=i.querySelectorAll("text")[1];d&&(d.style.display="none");const y=g.磁轴.所有按键.find(x=>x.按键===t);if(y&&y.行程设置.type==="行程设置"){let x=y.行程设置.行程按下,E=y.行程设置.行程抬起,r=i.querySelectorAll("text")[2],K=i.querySelectorAll("text")[3];r&&n.setText(r,x?.toFixed(e.travelPrecision)??"0.01"),K&&n.setText(K,E?.toFixed(e.travelPrecision)??"0.01")}};Object.values(p).forEach(i=>i.id[t].style.display="none"),!l&&!o?(n.show(p.default.id[t]),s(p.default.id[t])):!l&&o?(n.show(p.hover.id[t]),s(p.hover.id[t])):l&&!o?(n.show(p.current.id[t]),s(p.current.id[t])):l&&o&&(n.show(p.current_hover.id[t]),s(p.current_hover.id[t]))}),D.updateKeyboard(m,t=>{const _=F[t];if(!_)return;if(e.current键盘设置页SubpageIndex!==O.磁轴设置){Object.values(f).forEach(s=>s.id[t].style.display="none");return}const h=e.getCurrentDevice().磁轴.所有按键.find(s=>s.按键===t);if(h){const{RT:s}=h;e.getIs改键(t),e.getIs禁用(t);const i=e.getIs高级键改键(t);if(e.getIsSwapKey(t),!s||i){Object.values(f).forEach(c=>c.id[t].style.display="none");return}}let b=_.isHover,o=_.isSelected;o&&(e.当前选中按键_单键=t,e.当前选中按键_多键.includes(t)||e.当前选中按键_多键.push(t));const l=s=>{if(!s)return;const i=s.querySelectorAll("path")[0];i&&(i.style.display="none");const c=s.querySelectorAll("text")[1];c&&(c.style.display="none");const d=g.磁轴.所有按键.find(y=>y.按键===t);if(d&&d.行程设置.type==="行程设置"){let y=d.行程设置.行程按下,x=d.rt抬起,E=d.rt按下,r=s.querySelectorAll("text")[2],K=s.querySelectorAll("text")[3],u=s.querySelectorAll("text")[4];r&&n.setText(r,y.toFixed(e.travelPrecision)),K&&n.setText(K,E?.toFixed(e.travelPrecision)??"0.01"),u&&n.setText(u,x?.toFixed(e.travelPrecision)??"0.01")}};Object.values(f).forEach(s=>s.id[t].style.display="none"),!o&&!b?(n.show(f.default.id[t]),l(f.default.id[t])):!o&&b?(n.show(f.hover.id[t]),l(f.hover.id[t])):o&&!b?(n.show(f.current.id[t]),l(f.current.id[t])):o&&b&&(n.show(f.current_hover.id[t]),l(f.current_hover.id[t]))})}}),P.jsx(M,{divRef:A})};export{Q as Keyboard_81_beat75_KeyMappings_RT};
