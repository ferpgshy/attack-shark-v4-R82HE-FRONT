import{u as z,G as B,ao as J,j as N,V as Q,c as e,ap as M,键 as w,a9 as l,aq as H}from"./index.b078bf5f.js";import{u as F}from"./3ce44458.js";import{_ as X}from"./0027593c.js";import{_ as Y,a as Z}from"./fd426ddc.js";const et=()=>{z();const L=B();return J({ref:L,onInit:I=>{e.keyboardState=e.createKeyboardState();const T=M(X).Keyboard_89_SG8967_KeyMappings(I),K=M(Y).Keyboard_89_SG8967_RT_On(I),m=M(Z).Keyboard_89_SG8967_RT_Off(I);T.root.appendChild(m.root),m.root.appendChild(K.root);const _=new Set(["AudioVolumeUp","AudioVolumeMute","AudioVolumeDown"]),y=()=>e.current键盘设置页SubpageIndex===w.自定义按键||e.current键盘设置页SubpageIndex===w.磁轴设置||e.current键盘设置页SubpageIndex===w.高级设置;return F.addKeySelectionAndMappingEffects(T,_,y),F.addKeySelectionAndMappingEffects(m,_,y,"current"),F.addKeySelectionAndMappingEffects(K,_,y,"current"),_.forEach(u=>{Object.values(T.status).forEach(f=>{if(_.has(u)){const r=f.id[u];r&&(r.querySelectorAll("g").forEach(o=>{o.id.startsWith("Frame")}),r.querySelectorAll("path#Vector").forEach(o=>{}))}}),Object.values(m.status).forEach(f=>{if(_.has(u)){const r=f.id[u];r&&(r.querySelectorAll("g").forEach(a=>{a.id.startsWith("Frame")&&a.remove()}),r.querySelectorAll("path#Vector").forEach(a=>{a.setAttribute("fill","white")}),r.querySelectorAll("text").forEach(a=>{a.remove()}))}}),Object.values(K.status).forEach(f=>{if(_.has(u)){const r=f.id[u];r&&(r.querySelectorAll("g").forEach(a=>{a.id.startsWith("Frame")&&a.remove()}),r.querySelectorAll("path#Vector").forEach(a=>{a.setAttribute("fill","white")}),r.querySelectorAll("text").forEach(a=>{a.remove()}))}})}),{uiForRtOff:m,uiForRtOn:K,uiForKeyMappings:T,nonMagneticKeys:_}},onRefresh:({uiForRtOff:I,uiForRtOn:T,uiForKeyMappings:K,nonMagneticKeys:m})=>{const _=e.getCurrentDevice(),y=e.keyboardState.keys,u=T.status,f=I.status,r=K.status,O=()=>e.current键盘设置页SubpageIndex===w.自定义按键||e.current键盘设置页SubpageIndex===w.磁轴设置||e.current键盘设置页SubpageIndex===w.高级设置;F.updateKeyboard(K,t=>{const o=y[t];if(!o)return;const a=o.isHover,x=o.isSelected,v=e.getIs改键(t),d=e.getIs禁用(t),p=e.getIs高级键改键(t);if(e.current键盘设置页SubpageIndex===w.磁轴设置&&!p){K.status.default.id[t]&&Object.values(r).forEach(S=>{S.id[t]&&(S.id[t].style.display="none")});return}const s=e.getCurrentDevice().磁轴.所有按键.find(h=>h.按键===t);s&&s.RT&&Object.values(r).forEach(S=>{S.id[t]&&(S.id[t].style.display="none")});const n=h=>{if(!h)return;const E=e.getCurrentDevice()?.磁轴.所有按键.find(P=>P.按键===t);if(!E)return;const W=E?.轴体||"高特",j=h.querySelectorAll("path");let R=null,G=null;j.length>0&&(R=j[0],G=j[1]),R&&(m.has(t)?G&&G.setAttribute("fill","none"):R.setAttribute("fill",H(e.轴体颜色字典[W]||16771625)));const U=e.supportedSwitchTypes.findIndex(P=>P===W),V=h.querySelectorAll("text")[1];V&&(l.setText(V,String(U+1)),U+1>=10?V.setAttribute("dx","-0.5ch"):V.setAttribute("dx","0"))};Object.values(r).forEach(h=>{h.id[t]&&(h.id[t].style.display="none")});const D=x&&a,q=x&&!a,b=!x&&a,g=!x&&!a;let c;if(O()&&m.has(t)){l.show(r.default.id[t]),n(r.default.id[t]);return}const A=e.系统按键;if(e.isFnLayer&&A.has(t)){l.show(r.systemKey.id[t]),n(r.systemKey.id[t]);return}D?c=r.current_hover:q?c=r.current:b?v||p?c=r.changed:d?c=e.isFnLayer?r.hover:r.forbidden:c=r.hover:g&&(v||p?c=r.changed:d?e.isFnLayer?c=r.default:c=r.forbidden:c=r.default),c&&(l.show(c.id[t]),n(c.id[t]))}),F.updateKeyboard(I,t=>{const o=y[t];if(!o)return;if(e.current键盘设置页SubpageIndex!==w.磁轴设置){I.status.default.id[t]&&Object.values(f).forEach(n=>{n.id[t]&&(n.id[t].style.display="none")});return}const x=e.getCurrentDevice().磁轴.所有按键.find(s=>s.按键===t);e.getIs改键(t),e.getIs禁用(t);const v=e.getIs高级键改键(t);if(e.getIsSwapKey(t),x){const{RT:s}=x;if(new Set(e.getCurrentDevice()?.deviceType.other?.knobKeyCodes??[]),s||v){Object.values(f).forEach(n=>{n.id[t]&&(n.id[t].style.display="none")});return}}let d=o.isHover,p=o.isSelected;p&&(e.当前选中按键_单键=t,e.当前选中按键_多键.includes(t)||e.当前选中按键_多键.push(t));const i=s=>{if(!s)return;const n=_.磁轴.所有按键.find(A=>A.按键===t);if(!n)return;const D=n?.轴体||"高特",q=s.querySelectorAll("path");let b=null;q.length>0&&(b=q[0]),b&&!m.has(t)&&b.setAttribute("fill",H(e.轴体颜色字典[D]||16771625));const g=e.supportedSwitchTypes.findIndex(A=>A===D),c=s.querySelectorAll("text")[1];if(c&&(l.setText(c,String(g+1)),g+1>=10?c.setAttribute("dx","-0.5ch"):c.setAttribute("dx","0")),n&&n.行程设置.type==="行程设置"){let A=n.行程设置.行程按下,h=n.行程设置.行程抬起,S=s.querySelectorAll("text")[2],E=s.querySelectorAll("text")[3];S&&l.setText(S,A?.toFixed(e.travelPrecision)??"0.01"),E&&l.setText(E,h?.toFixed(e.travelPrecision)??"0.01")}};Object.values(f).forEach(s=>{s.id[t]&&(s.id[t].style.display="none")}),!p&&!d?(l.show(f.default.id[t]),i(f.default.id[t])):!p&&d?(l.show(f.hover.id[t]),i(f.hover.id[t])):p&&!d?(l.show(f.current.id[t]),i(f.current.id[t])):p&&d&&(l.show(f.current_hover.id[t]),i(f.current_hover.id[t]))}),F.updateKeyboard(T,t=>{const o=y[t];if(!o)return;if(e.current键盘设置页SubpageIndex!==w.磁轴设置){Object.values(u).forEach(i=>{i.id[t]&&(i.id[t].style.display="none")});return}const x=e.getCurrentDevice().磁轴.所有按键.find(i=>i.按键===t);if(x){const{RT:i}=x;e.getIs改键(t),e.getIs禁用(t);const s=e.getIs高级键改键(t);if(e.getIsSwapKey(t),new Set(e.getCurrentDevice()?.deviceType.other?.knobKeyCodes??[]),!i||s){Object.values(u).forEach(n=>{n.id[t]&&(n.id[t].style.display="none")});return}}let v=o.isHover,d=o.isSelected;d&&(e.当前选中按键_单键=t,e.当前选中按键_多键.includes(t)||e.当前选中按键_多键.push(t));const p=i=>{if(!i)return;const s=_.磁轴.所有按键.find(g=>g.按键===t);if(!s)return;const n=s?.轴体||"高特",D=i.querySelectorAll("path")[0];D&&D.setAttribute("fill",H(e.轴体颜色字典[n]||16771625));const q=e.supportedSwitchTypes.findIndex(g=>g===n),b=i.querySelectorAll("text")[1];if(b&&(l.setText(b,String(q+1)),q+1>=10?b.setAttribute("dx","-0.5ch"):b.setAttribute("dx","0")),s&&s.行程设置.type==="行程设置"){let g=s.行程设置.行程按下,c=s.rt抬起,A=s.rt按下,h=i.querySelectorAll("text")[2],S=i.querySelectorAll("text")[3],E=i.querySelectorAll("text")[4];h&&l.setText(h,g.toFixed(e.travelPrecision)),S&&l.setText(S,A?.toFixed(e.travelPrecision)??"0.01"),E&&l.setText(E,c?.toFixed(e.travelPrecision)??"0.01")}};Object.values(u).forEach(i=>{i.id[t]&&(i.id[t].style.display="none")}),!d&&!v?(l.show(u.default.id[t]),p(u.default.id[t])):!d&&v?(l.show(u.hover.id[t]),p(u.hover.id[t])):d&&!v?(l.show(u.current.id[t]),p(u.current.id[t])):d&&v&&(l.show(u.current_hover.id[t]),p(u.current_hover.id[t]))})}}),N.jsx(Q,{divRef:L})};export{et as Keyboard_89_SG8967_KeyMappings_RT};
