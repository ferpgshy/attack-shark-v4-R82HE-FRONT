import{ai as d,al as g,an as _}from"./index.b078bf5f.js";import{C as B}from"./5e635fe2.js";class C extends B{getDeviceIsBoot=async()=>{const n=await this.commonMsg(new Uint8Array([143]),d.Bit7);return n!==void 0&&n[9]===1};BOOT_INFOS=[{vid:12625,pid:20481}];upgrade_dev=async(n,i,c,h)=>{h(0);const t=n.slice(c),e=64,a=Math.ceil(t.length/e),u=[a&255,(a&65280)>>8,(a&16711680)>>16,(a&4278190080)>>24],v=[186,192,0,0,0,0,0,0,...u];let m,l=0;for(;m===void 0&&l<10;)m=await this.commonMsgByPath(new Uint8Array(v),d.None,i),l++,await g(1e3);if(m===void 0)return!1;for(let s=0;s<a;s++){const p=s*e>t.length?e-(s*e-t.length):e,w=t.slice(s*e,s*e+p);if(!await this.sendMsgByPath(w,d.None,i))return!1;h(s/a)}const r=_([...t]),o=new Uint8Array(4);o[0]=r&255,o[1]=(r&65280)>>8,o[2]=(r&16711680)>>16,o[3]=(r&4278190080)>>24;const y=[186,194,0,0,0,0,0,0,...u,...o],f=await this.commonMsgByPath(new Uint8Array(y),d.None,i,10,100);return f!==void 0&&f[2]===85};upgrade=async(n,i)=>{if(i(0),this.deviceType.isBoot&&!this.BOOT_INFOS.some(t=>t.vid===this.deviceType.vid&&t.pid===this.deviceType.pid))return!1;const c=await this.boot_usb();return c===void 0?!1:await this.upgrade_dev(n,c,65536,i)}}export{C};
