import{u as G,G as U,ao as z,j as J,V as Q,c as e,ap as P,键 as A,a9 as l,aq as M}from"./index.b078bf5f.js";import{u as F}from"./3ce44458.js";import{_ as X}from"./a9ff247d.js";import{_ as Y,a as Z}from"./a8546291.js";const et=()=>{G();const H=U();return z({ref:H,onInit:D=>{e.keyboardState=e.createKeyboardState();const E=P(X).Keyboard_82_NBD_IK75_KeyMappings(D),w=P(Y).Keyboard_82_NBD_IK75_RT_On(D),m=P(Z).Keyboard_82_NBD_IK75_RT_Off(D);E.root.appendChild(m.root),m.root.appendChild(w.root);const x=new Set(["AudioVolumeUp","AudioVolumeMute","AudioVolumeDown"]),T=()=>e.current键盘设置页SubpageIndex===A.自定义按键||e.current键盘设置页SubpageIndex===A.磁轴设置||e.current键盘设置页SubpageIndex===A.高级设置;return F.addKeySelectionAndMappingEffects(E,x,T),F.addKeySelectionAndMappingEffects(m,x,T,"current"),F.addKeySelectionAndMappingEffects(w,x,T,"current"),x.forEach(u=>{Object.values(E.status).forEach(f=>{if(x.has(u)){const r=f.id[u];r&&(r.querySelectorAll("g").forEach(o=>{o.id.startsWith("Frame")}),r.querySelectorAll("path#Vector").forEach(o=>{}))}}),Object.values(m.status).forEach(f=>{if(x.has(u)){const r=f.id[u];r&&(r.querySelectorAll("g").forEach(a=>{a.id.startsWith("Frame")&&a.remove()}),r.querySelectorAll("path#Vector").forEach(a=>{a.setAttribute("fill","white")}),r.querySelectorAll("text").forEach(a=>{a.remove()}))}}),Object.values(w.status).forEach(f=>{if(x.has(u)){const r=f.id[u];r&&(r.querySelectorAll("g").forEach(a=>{a.id.startsWith("Frame")&&a.remove()}),r.querySelectorAll("path#Vector").forEach(a=>{a.setAttribute("fill","white")}),r.querySelectorAll("text").forEach(a=>{a.remove()}))}})}),{uiForRtOff:m,uiForRtOn:w,uiForKeyMappings:E,nonMagneticKeys:x}},onRefresh:({uiForRtOff:D,uiForRtOn:E,uiForKeyMappings:w,nonMagneticKeys:m})=>{const x=e.getCurrentDevice(),T=e.keyboardState.keys,u=E.status,f=D.status,r=w.status,O=()=>e.current键盘设置页SubpageIndex===A.自定义按键||e.current键盘设置页SubpageIndex===A.磁轴设置||e.current键盘设置页SubpageIndex===A.高级设置;F.updateKeyboard(w,t=>{const o=T[t];if(!o)return;const a=o.isHover,S=o.isSelected,v=e.getIs改键(t),d=e.getIs禁用(t),p=e.getIs高级键改键(t);if(e.current键盘设置页SubpageIndex===A.磁轴设置&&!p){w.status.default.id[t]&&Object.values(r).forEach(_=>{_.id[t]&&(_.id[t].style.display="none")});return}const s=e.getCurrentDevice().磁轴.所有按键.find(h=>h.按键===t);s&&s.RT&&Object.values(r).forEach(_=>{_.id[t]&&(_.id[t].style.display="none")});const n=h=>{if(!h)return;const I=e.getCurrentDevice()?.磁轴.所有按键.find(N=>N.按键===t);if(!I)return;const L=I?.轴体||"高特",j=h.querySelectorAll("path");let R=null,B=null;j.length>0&&(R=j[0],B=j[1]),R&&(m.has(t)?B&&B.setAttribute("fill","none"):R.setAttribute("fill",M(e.轴体颜色字典[L]||16771625)));const W=e.supportedSwitchTypes.findIndex(N=>N===L),V=h.querySelectorAll("text")[1];V&&(l.setText(V,String(W+1)),W+1>=10?V.setAttribute("dx","-0.5ch"):V.setAttribute("dx","0"))};Object.values(r).forEach(h=>{h.id[t]&&(h.id[t].style.display="none")});const y=S&&a,q=S&&!a,b=!S&&a,g=!S&&!a;let c;if(O()&&m.has(t)){l.show(r.default.id[t]),n(r.default.id[t]);return}const K=e.系统按键;if(e.isFnLayer&&K.has(t)){l.show(r.systemKey.id[t]),n(r.systemKey.id[t]);return}y?c=r.current_hover:q?c=r.current:b?v||p?c=r.changed:d?c=e.isFnLayer?r.hover:r.forbidden:c=r.hover:g&&(v||p?c=r.changed:d?e.isFnLayer?c=r.default:c=r.forbidden:c=r.default),c&&(l.show(c.id[t]),n(c.id[t]))}),F.updateKeyboard(D,t=>{const o=T[t];if(!o)return;if(e.current键盘设置页SubpageIndex!==A.磁轴设置){D.status.default.id[t]&&Object.values(f).forEach(n=>{n.id[t]&&(n.id[t].style.display="none")});return}const S=e.getCurrentDevice().磁轴.所有按键.find(s=>s.按键===t);e.getIs改键(t),e.getIs禁用(t);const v=e.getIs高级键改键(t);if(e.getIsSwapKey(t),S){const{RT:s}=S;if(new Set(e.getCurrentDevice()?.deviceType.other?.knobKeyCodes??[]),s||v){Object.values(f).forEach(n=>{n.id[t]&&(n.id[t].style.display="none")});return}}let d=o.isHover,p=o.isSelected;p&&(e.当前选中按键_单键=t,e.当前选中按键_多键.includes(t)||e.当前选中按键_多键.push(t));const i=s=>{if(!s)return;const n=x.磁轴.所有按键.find(K=>K.按键===t);if(!n)return;const y=n?.轴体||"高特",q=s.querySelectorAll("path");let b=null;q.length>0&&(b=q[0]),b&&!m.has(t)&&b.setAttribute("fill",M(e.轴体颜色字典[y]||16771625));const g=e.supportedSwitchTypes.findIndex(K=>K===y),c=s.querySelectorAll("text")[1];if(c&&(l.setText(c,String(g+1)),g+1>=10?c.setAttribute("dx","-0.5ch"):c.setAttribute("dx","0")),n&&n.行程设置.type==="行程设置"){let K=n.行程设置.行程按下,h=n.行程设置.行程抬起,_=s.querySelectorAll("text")[2],I=s.querySelectorAll("text")[3];_&&l.setText(_,K?.toFixed(e.travelPrecision)??"0.01"),I&&l.setText(I,h?.toFixed(e.travelPrecision)??"0.01")}};Object.values(f).forEach(s=>{s.id[t]&&(s.id[t].style.display="none")}),!p&&!d?(l.show(f.default.id[t]),i(f.default.id[t])):!p&&d?(l.show(f.hover.id[t]),i(f.hover.id[t])):p&&!d?(l.show(f.current.id[t]),i(f.current.id[t])):p&&d&&(l.show(f.current_hover.id[t]),i(f.current_hover.id[t]))}),F.updateKeyboard(E,t=>{const o=T[t];if(!o)return;if(e.current键盘设置页SubpageIndex!==A.磁轴设置){Object.values(u).forEach(i=>{i.id[t]&&(i.id[t].style.display="none")});return}const S=e.getCurrentDevice().磁轴.所有按键.find(i=>i.按键===t);if(S){const{RT:i}=S;e.getIs改键(t),e.getIs禁用(t);const s=e.getIs高级键改键(t);if(e.getIsSwapKey(t),new Set(e.getCurrentDevice()?.deviceType.other?.knobKeyCodes??[]),!i||s){Object.values(u).forEach(n=>{n.id[t]&&(n.id[t].style.display="none")});return}}let v=o.isHover,d=o.isSelected;d&&(e.当前选中按键_单键=t,e.当前选中按键_多键.includes(t)||e.当前选中按键_多键.push(t));const p=i=>{if(!i)return;const s=x.磁轴.所有按键.find(g=>g.按键===t);if(!s)return;const n=s?.轴体||"高特",y=i.querySelectorAll("path")[0];y&&y.setAttribute("fill",M(e.轴体颜色字典[n]||16771625));const q=e.supportedSwitchTypes.findIndex(g=>g===n),b=i.querySelectorAll("text")[1];if(b&&(l.setText(b,String(q+1)),q+1>=10?b.setAttribute("dx","-0.5ch"):b.setAttribute("dx","0")),s&&s.行程设置.type==="行程设置"){let g=s.行程设置.行程按下,c=s.rt抬起,K=s.rt按下,h=i.querySelectorAll("text")[2],_=i.querySelectorAll("text")[3],I=i.querySelectorAll("text")[4];h&&l.setText(h,g.toFixed(e.travelPrecision)),_&&l.setText(_,K?.toFixed(e.travelPrecision)??"0.01"),I&&l.setText(I,c?.toFixed(e.travelPrecision)??"0.01")}};Object.values(u).forEach(i=>{i.id[t]&&(i.id[t].style.display="none")}),!d&&!v?(l.show(u.default.id[t]),p(u.default.id[t])):!d&&v?(l.show(u.hover.id[t]),p(u.hover.id[t])):d&&!v?(l.show(u.current.id[t]),p(u.current.id[t])):d&&v&&(l.show(u.current_hover.id[t]),p(u.current_hover.id[t]))})}}),J.jsx(Q,{divRef:H})};export{et as Keyboard_82_NBD_IK75_v3_KeyMappings_RT};
