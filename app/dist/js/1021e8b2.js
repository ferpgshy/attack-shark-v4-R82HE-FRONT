import{u as h,a as j,r as o,c as e,b as w,K as D,P as F,d as i,y as u,j as t,V as s,f as p,e as d}from"./index.b078bf5f.js";import{C as b}from"./532dcef2.js";import{g as _}from"./0a36fd0f.js";const P=()=>{h();const n=j(),[a,y]=o.useState(3),[f,x]=o.useState(!1),l=e.getCurrentDevice().deviceType,m=w(D.FirmwareUpgrade);o.useEffect(()=>{const r=setTimeout(()=>{a>0?y(a-1):x(!0)},1e3);return()=>clearTimeout(r)},[a]);const g=e.toastOptions,C=async()=>{if(e.getCurrentDevice().设备升级.需要升级的列表.length===0){u.info(n.当前设备固件为最新无需升级,g);return}e.getCurrentDevice().设备升级.升级事件==="none_调用结束"&&(e.getCurrentDevice().设备升级.升级事件="start_开始调用")},v=async()=>{e.getCurrentDevice().设备升级.升级事件==="none_调用结束"&&(e.getCurrentDevice().设备升级.升级事件="start_开始调用")};e.getCurrentDevice().设备升级.升级事件!=="none_调用结束"&&e.getCurrentDevice().deviceType.isBoot,o.useEffect(()=>{e.getCurrentDevice().设备升级.state.progress>0&&e.getCurrentDevice().设备升级.state.errMsg===""||e.getCurrentDevice().设备升级.state.errMsg!==""&&F.next({type:"error",message:"固件升级失败!(升级失败请插拔重试)"})},[e.getCurrentDevice().设备升级.升级事件]),o.useEffect(()=>()=>{const r=i.getCurrentDevice();r?.设备升级.升级事件==="none_调用结束"&&r?.设备升级.state.progress>0&&!r.deviceType.isBoot&&i.isDeviceConnected&&(i.isAutoConnectWhenDeviceIsConnected=!0,u.success(n.固件升级完成,g))},[]),o.useEffect(()=>()=>{e.isShowFirmwareUpgradePage&&(e.isShowFirmwareUpgradePage=!1)},[e.isShowFirmwareUpgradePage]);const c=_(l.type==="mouse"?l.mouseLayout:"default");return t.jsx(s,{type:"上下",w:"full",h:"full",style:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.8)",zIndex:1e5,display:"flex",justifyContent:"center",alignItems:"center"},onClick:r=>r.stopPropagation(),children:e.getCurrentDevice().deviceType.type!=null&&t.jsx(t.Fragment,{children:i.isShowFirmwareUpgradeSuccessDialogBeforeWelcomePage?t.jsxs(s,{type:"上下",w:486,style:{backgroundColor:"var(--color-background-white)",padding:"20px",borderRadius:"12px",gap:"16px",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:1e3},children:[t.jsx(s,{w:400,h:40,type:"上下",style:{borderBottom:"1px solid #E0E0E0",paddingBottom:"12px",alignItems:"center",justifyContent:"center"},children:t.jsx(d,{type:"小标题",text:n.提示})}),t.jsx(d,{type:"提示文本",text:n.固件升级成功提示文本}),t.jsx(s,{type:"上下",w:"full",style:{gap:"12px",padding:"16px"},children:t.jsx(s,{type:"左右___主轴居中",w:"full",style:{alignItems:"center",justifyContent:"space-between"},children:t.jsx(p,{text:n.确认,onClick:()=>{e.isShowFirmwareUpgradeSuccessDialogBeforeWelcomePage=!1,i.isShowWelcomePage||(i.isShowWelcomePage=!0)}})})})]}):t.jsxs(t.Fragment,{children:[!e.getCurrentDevice().deviceType.isBoot&&e.getCurrentDevice().deviceType.type==="keyboard"&&t.jsx(s,{type:"上下",style:{backgroundColor:"#FFFFFF",padding:"10px",borderRadius:"10px",position:"relative",zIndex:1e3,pointerEvents:"none"},onClick:r=>r.stopPropagation(),children:m}),!e.getCurrentDevice().deviceType.isBoot&&e.getCurrentDevice().deviceType.type!="keyboard"&&t.jsx(s,{type:"上下",style:{backgroundColor:"#FFFFFF",padding:"10px",borderRadius:"10px",position:"relative",zIndex:1e3,pointerEvents:"none"},onClick:r=>r.stopPropagation(),children:t.jsx(s,{type:"上下",w:c.mouse_w,h:c.mouse_h,children:t.jsx("img",{src:c.mouse_url,style:{width:"100%",height:"100%"}})})}),e.getCurrentDevice().设备升级.升级事件!=="none_调用结束"?t.jsxs(s,{type:"上下",w:"full",style:{justifyContent:"center",alignItems:"center",gap:"20px",padding:"20px"},children:[t.jsx(b,{progress:Math.floor(e.getCurrentDevice().设备升级.state.progress*100)}),t.jsx("span",{style:{fontSize:"20px",fontFamily:"var(--font-family-regular)",color:"red"},children:n.固件升级进度条文本}),t.jsx("span",{style:{fontSize:"20px",fontFamily:"var(--font-family-regular)",color:"red"},children:`${Math.floor(e.getCurrentDevice().设备升级.state.progress*100)}%`})]}):t.jsxs(t.Fragment,{children:[t.jsx(s,{type:"左右",w:"full",h:"100px",style:{justifyContent:"center",alignItems:"center"},onClick:r=>r.stopPropagation(),children:e.getCurrentDevice().设备升级.升级事件!=="ing_调用中"&&t.jsx(s,{type:"上下",style:{gap:"10px"},children:t.jsx("span",{style:{fontSize:"20px",fontFamily:"var(--font-family-regular)",color:"red"},children:n.固件升级提示文本})})}),t.jsxs(s,{type:"左右",h:"100px",style:{justifyContent:"center",alignItems:"center",gap:"100px"},children:[t.jsx(p,{text:n.取消,onClick:()=>{e.isShowFirmwareUpgradePage=!1}}),t.jsx(p,{text:n.确定+(a>0?` (${a}s)`:""),disabled:!f,onClick:()=>{e.getCurrentDevice().deviceType.isBoot?v():C()}})]})]})]})})})};export{P as F};
