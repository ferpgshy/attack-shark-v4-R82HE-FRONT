import{u as L,G,ao as z,j as B,V as J,c as e,ap as O,键 as R,a9 as a,aq as j}from"./index.b078bf5f.js";import{u as I}from"./3ce44458.js";import{_ as N}from"./f60b2069.js";import{_ as Q,a as U}from"./ff9abfe5.js";const $=()=>{L();const q=G();return z({ref:q,onInit:x=>{e.keyboardState=e.createKeyboardState();const w=O(N).Keyboard_81_beat75_KeyMappings(x),g=O(Q).Keyboard_81_beat75_RT_On(x),v=O(U).Keyboard_81_beat75_RT_Off(x);return w.root.appendChild(v.root),v.root.appendChild(g.root),I.addKeySelectionAndMappingEffects(w),I.addKeySelectionAndMappingEffects(v),I.addKeySelectionAndMappingEffects(g),{uiForRtOff:v,uiForRtOn:g,uiForKeyMappings:w}},onRefresh:({uiForRtOff:x,uiForRtOn:w,uiForKeyMappings:g})=>{const v=e.getCurrentDevice(),E=e.keyboardState.keys,p=w.status,h=x.status,l=g.status;I.updateKeyboard(g,t=>{const _=E[t];if(!_)return;const m=_.isHover,d=_.isSelected,b=e.getIs改键(t),u=e.getIs禁用(t),f=e.getIs高级键改键(t);if(e.current键盘设置页SubpageIndex===R.磁轴设置&&!f){g.status.default.id[t]&&Object.values(l).forEach(o=>{o.id[t]&&(o.id[t].style.display="none")});return}const s=e.getCurrentDevice().磁轴.所有按键.find(c=>c.按键===t);s&&s.RT&&Object.values(l).forEach(o=>{o.id[t]&&(o.id[t].style.display="none")});const r=c=>{if(!c)return;const A=e.getCurrentDevice()?.磁轴.所有按键.find(F=>F.按键===t);if(!A)return;const V=A?.轴体||"高特",P=c.querySelectorAll("path")[0];P&&P.setAttribute("fill",j(e.轴体颜色字典[V]||16771625));const H=e.supportedSwitchTypes.findIndex(F=>F===V),M=c.querySelectorAll("text")[1];M&&a.setText(M,String(H+1))};Object.values(l).forEach(c=>{c.id[t]&&(c.id[t].style.display="none")});const K=d&&m,T=d&&!m,y=!d&&m,S=!d&&!m;let n;const D=e.系统按键;if(e.isFnLayer&&D.has(t)){a.show(l.systemKey.id[t]),r(l.systemKey.id[t]);return}K?n=l.current_hover:T?n=l.current:y?b||f?n=l.changed:u?n=e.isFnLayer?l.hover:l.forbidden:n=l.hover:S&&(b||f?n=l.changed:u?e.isFnLayer?n=l.default:n=l.forbidden:n=l.default),n&&(a.show(n.id[t]),r(n.id[t]))}),I.updateKeyboard(x,t=>{const _=E[t];if(!_)return;if(e.current键盘设置页SubpageIndex!==R.磁轴设置){x.status.default.id[t]&&Object.values(h).forEach(r=>{r.id[t]&&(r.id[t].style.display="none")});return}const d=e.getCurrentDevice().磁轴.所有按键.find(s=>s.按键===t);e.getIs改键(t),e.getIs禁用(t);const b=e.getIs高级键改键(t);if(e.getIsSwapKey(t),d){const{RT:s}=d;if(s||b){Object.values(h).forEach(r=>{r.id[t]&&(r.id[t].style.display="none")});return}}let u=_.isHover,f=_.isSelected;f&&(e.当前选中按键_单键=t,e.当前选中按键_多键.includes(t)||e.当前选中按键_多键.push(t));const i=s=>{if(!s)return;const r=v.磁轴.所有按键.find(n=>n.按键===t);if(!r)return;const K=r?.轴体||"高特",T=s.querySelectorAll("path")[0];T&&T.setAttribute("fill",j(e.轴体颜色字典[K]||16771625));const y=e.supportedSwitchTypes.findIndex(n=>n===K),S=s.querySelectorAll("text")[1];if(S&&a.setText(S,String(y+1)),r&&r.行程设置.type==="行程设置"){let n=r.行程设置.行程按下,D=r.行程设置.行程抬起,c=s.querySelectorAll("text")[2],o=s.querySelectorAll("text")[3];c&&a.setText(c,n?.toFixed(e.travelPrecision)??"0.01"),o&&a.setText(o,D?.toFixed(e.travelPrecision)??"0.01")}};Object.values(h).forEach(s=>{s.id[t]&&(s.id[t].style.display="none")}),!f&&!u?(a.show(h.default.id[t]),i(h.default.id[t])):!f&&u?(a.show(h.hover.id[t]),i(h.hover.id[t])):f&&!u?(a.show(h.current.id[t]),i(h.current.id[t])):f&&u&&(a.show(h.current_hover.id[t]),i(h.current_hover.id[t]))}),I.updateKeyboard(w,t=>{const _=E[t];if(!_)return;if(e.current键盘设置页SubpageIndex!==R.磁轴设置){Object.values(p).forEach(i=>{i.id[t]&&(i.id[t].style.display="none")});return}const d=e.getCurrentDevice().磁轴.所有按键.find(i=>i.按键===t);if(d){const{RT:i}=d;e.getIs改键(t),e.getIs禁用(t);const s=e.getIs高级键改键(t);if(e.getIsSwapKey(t),!i||s){Object.values(p).forEach(r=>{r.id[t]&&(r.id[t].style.display="none")});return}}let b=_.isHover,u=_.isSelected;u&&(e.当前选中按键_单键=t,e.当前选中按键_多键.includes(t)||e.当前选中按键_多键.push(t));const f=i=>{if(!i)return;const s=v.磁轴.所有按键.find(S=>S.按键===t);if(!s)return;const r=s?.轴体||"高特",K=i.querySelectorAll("path")[0];K&&K.setAttribute("fill",j(e.轴体颜色字典[r]||16771625));const T=e.supportedSwitchTypes.findIndex(S=>S===r),y=i.querySelectorAll("text")[1];if(y&&a.setText(y,String(T+1)),s&&s.行程设置.type==="行程设置"){let S=s.行程设置.行程按下,n=s.rt抬起,D=s.rt按下,c=i.querySelectorAll("text")[2],o=i.querySelectorAll("text")[3],A=i.querySelectorAll("text")[4];c&&a.setText(c,S.toFixed(e.travelPrecision)),o&&a.setText(o,D?.toFixed(e.travelPrecision)??"0.01"),A&&a.setText(A,n?.toFixed(e.travelPrecision)??"0.01")}};Object.values(p).forEach(i=>{i.id[t]&&(i.id[t].style.display="none")}),!u&&!b?(a.show(p.default.id[t]),f(p.default.id[t])):!u&&b?(a.show(p.hover.id[t]),f(p.hover.id[t])):u&&!b?(a.show(p.current.id[t]),f(p.current.id[t])):u&&b&&(a.show(p.current_hover.id[t]),f(p.current_hover.id[t]))})}}),B.jsx(J,{divRef:q})};export{$ as Keyboard_81_beat75_v2_KeyMappings_RT};
