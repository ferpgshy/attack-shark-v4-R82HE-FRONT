import{ai as n}from"./index.b078bf5f.js";import{C as v}from"./5e635fe2.js";class r extends v{BOOT_INFOS=[{vid:12625,pid:20567}];boot_usb=async()=>{if(this.BOOT_INFOS.some(e=>e.vid===this.deviceType.vid&&e.pid===this.deviceType.pid))return this.deviceType.devAddr.toString();await this.sendMsg(new Uint8Array([127,85,170,85,170]),n.Bit7),await sleep(1e3*1);let d=0,i;for(;i===void 0&&d<100;)await sleep(500),i=IOTConnector.devlistList.find(e=>e.oneofDev.oneofKind==="dev"&&e.oneofDev.dev.devType===DeviceType.YZWBoot&&this.BOOT_INFOS.some(t=>e.oneofDev.oneofKind==="dev"&&t.vid===e.oneofDev.dev.vid&&t.pid===e.oneofDev.dev.pid)),d++;if(!(i===void 0||i.oneofDev.oneofKind!=="dev"))return i.oneofDev.dev.path};findSameDevPath=async d=>{let i=0,e;for(;e===void 0&&i<20;){await sleep(500);const t=IOTConnector.devlistList.find(o=>o.oneofDev.oneofKind==="dev"&&(o.oneofDev.dev.path===this.deviceType.devAddr||o.oneofDev.dev.id===this.deviceType.id||d!==void 0&&o.oneofDev.dev.id===d));e=t?.oneofDev.oneofKind==="dev"?t.oneofDev.dev.path:void 0,i++}if(e!==void 0)return e};upgrade=async(d,i)=>{if(i(0),this.deviceType.isBoot&&!this.BOOT_INFOS.some(o=>o.vid===this.deviceType.vid&&o.pid===this.deviceType.pid))return!1;const e=await this.boot_usb();return e===void 0?!1:await this.upgrade_dev(d,e,20480,i)}}export{r as C};
