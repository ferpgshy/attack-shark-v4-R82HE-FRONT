import{u as _,a as m,r as l,c as a,d as t,j as e,V as s,e as d,f as j,N as F,U as y,y as h,O as E}from"./index.b078bf5f.js";import{F as R}from"./1021e8b2.js";import"./532dcef2.js";import"./0a36fd0f.js";const P=()=>{_();const i=m();return l.useState(""),a.toastOptions,l.useEffect(()=>{t.getCurrentDevice().deviceType.isBoot||(t.isShowDeviceRecoveryPage&&(t.isShowDeviceRecoveryPage=!1),t.isShowWelcomePage||(t.isShowWelcomePage=!0))},[t.getCurrentDevice().deviceType.isBoot]),e.jsx(s,{type:"左右___主轴居中",className:"electron__drag",w:"full",h:"full",style:{alignItems:"center",position:"relative",background:"#3E3E3E"},children:e.jsxs(s,{type:"上下",w:"full",style:{alignItems:"center"},children:[e.jsxs(s,{type:"上下",w:411,style:{marginBottom:"109px"},children:[e.jsx(d,{type:"正文内容_黑底白字",text:i.救援模式提示文本1}),e.jsx(d,{type:"正文内容_黑底白字",text:i.救援模式提示文本2})]}),e.jsx(C,{}),t.isShowFirmwareUpgradePage&&a.getCurrentDevice().deviceType.type!=null&&e.jsx(R,{})]})})},C=()=>{const i=m(),[w,D]=l.useState(""),f=async()=>{const o=a.toastOptions;t.deviceIdToRecovery=Number(w);const u=a.getCurrentDevice().deviceType,p=F.devlistList.find(n=>n.oneofDev.oneofKind==="dev"&&n.oneofDev.dev.path===u.devAddr),S=t.deviceIdToRecovery,g=await y.getFwVersion(Number(S));if(g.errCode!==0){h.error(i.未找到当前可升级的固件请检查ID,o);return}const v=g.data,x=v.version_str.match(/[^_]+/gi);if(x===null||x.length===0)return;const r=await y.downloadAllDevUpgradeFile(v);if(r===void 0||r.fw===void 0)return;const c=[];if(u.isBoot&&(p!=null&&E.some(n=>p.oneofDev.oneofKind==="dev"&&p.oneofDev.dev.vid===n.vid&&p.oneofDev.dev.pid===n.pid)?c.push({method:"usb",file:r.fw}):r.fwRF!==void 0&&c.push({method:"rf",file:r.fwRF})),c.length===0){h.error(i.未找到当前可升级的固件,o),t.isShowFirmwareUpgradePage=!1,t._isShowDeviceRecoveryPage=!0;return}a.getCurrentDevice().设备升级.需要升级的列表=c,t.isShowFirmwareUpgradePage=!0};return e.jsxs(s,{type:"上下",className:"no-drag",w:486,h:258,style:{background:"#F9F9F9",borderRadius:"12px",padding:"22px 38px"},children:[e.jsx(s,{type:"左右",style:{fontSize:"20px",fontFamily:"Source Han Sans SC",fontWeight:500,color:"#3E3E3E",marginBottom:"16px"},children:e.jsx(d,{type:"一级标题栏_高亮",text:i.提示})}),e.jsx(s,{w:411,h:1,style:{background:"#D5D5D5",marginBottom:"14px"}}),e.jsx(s,{style:{fontSize:"18px",fontFamily:"Source Han Sans SC",fontWeight:400,color:"#3E3E3E",marginBottom:"19px"},children:e.jsx(d,{type:"小标题",text:i.请输入您的设备id})}),e.jsx(s,{w:411,h:48,style:{border:"1px solid #D5D5D5",borderRadius:"6px",marginBottom:"35px",padding:"0 12px",userSelect:"none"},children:e.jsx("input",{type:"text",maxLength:4,onChange:o=>{D(o.target.value)},onKeyDown:o=>{!/[0-9]/.test(o.key)&&o.key!=="Backspace"&&o.key!=="Enter"&&(o.preventDefault(),o.key==="Enter"&&f())},style:{width:"100%",height:"100%",border:"none",outline:"none",background:"transparent",fontSize:"16px",fontFamily:"var(--font-family-regular)",userSelect:"none"}})}),e.jsx(s,{type:"左右___主轴居中",children:e.jsx(j,{text:i.确定,style:{width:"120px",height:"32px",fontSize:"14px"},onClick:f})})]})};export{P as Page_RecoveryMode};
