import{u as H,G as L,ao as G,j as z,V as J,c as e,ap as M,键 as j,a9 as a,aq as q}from"./index.b078bf5f.js";import{u as T}from"./3ce44458.js";import{_ as N}from"./8117b76c.js";import{_ as Q,a as U}from"./528233b2.js";const $=()=>{H();const V=L();return G({ref:V,onInit:g=>{e.keyboardState=e.createKeyboardState();const m=M(N).Keyboard_81_MK830_KeyMappings(g),v=M(Q).Keyboard_81_MK830_RT_On(g),K=M(U).Keyboard_81_MK830_RT_Off(g);return m.root.appendChild(K.root),K.root.appendChild(v.root),T.addKeySelectionAndMappingEffects(m),T.addKeySelectionAndMappingEffects(K),T.addKeySelectionAndMappingEffects(v),{uiForRtOff:K,uiForRtOn:v,uiForKeyMappings:m}},onRefresh:({uiForRtOff:g,uiForRtOn:m,uiForKeyMappings:v})=>{const K=e.getCurrentDevice(),E=e.keyboardState.keys,f=m.status,p=g.status,l=v.status;T.updateKeyboard(v,t=>{const d=E[t];if(!d)return;const D=d.isHover,_=d.isSelected,y=e.getIs改键(t),u=e.getIs禁用(t),o=e.getIs高级键改键(t);if(e.current键盘设置页SubpageIndex===j.磁轴设置&&!o){v.status.default.id[t]&&Object.values(l).forEach(S=>{S.id[t].style.display="none"});return}const s=e.getCurrentDevice().磁轴.所有按键.find(c=>c.按键===t);s&&s.RT&&Object.values(l).forEach(S=>S.id[t].style.display="none");const n=c=>{if(!c)return;const A=e.getCurrentDevice()?.磁轴.所有按键.find(R=>R.按键===t);if(!A)return;const P=A?.轴体||"高特",F=c.querySelectorAll("path")[0];F&&(e.shouldSwitchBeDisplayed?F.setAttribute("fill",q(e.轴体颜色字典[P]||16771625)):F.style.display="none");const B=e.supportedSwitchTypes.findIndex(R=>R===P),O=c.querySelectorAll("text")[1];O&&(e.shouldSwitchBeDisplayed?a.setText(O,String(B+1)):O.style.display="none")};Object.values(l).forEach(c=>c.id[t].style.display="none");const x=_&&D,b=_&&!D,w=!_&&D,h=!_&&!D;let r;const I=e.系统按键;if(e.isFnLayer&&I.has(t)){a.show(l.systemKey.id[t]),n(l.systemKey.id[t]);return}x?r=l.current_hover:b?r=l.current:w?y||o?r=l.changed:u?r=e.isFnLayer?l.hover:l.forbidden:r=l.hover:h&&(y||o?r=l.changed:u?e.isFnLayer?r=l.default:r=l.forbidden:r=l.default),r&&(a.show(r.id[t]),n(r.id[t]))}),T.updateKeyboard(g,t=>{const d=E[t];if(!d)return;if(e.current键盘设置页SubpageIndex!==j.磁轴设置){g.status.default.id[t]&&Object.values(p).forEach(n=>n.id[t].style.display="none");return}const _=e.getCurrentDevice().磁轴.所有按键.find(s=>s.按键===t);e.getIs改键(t),e.getIs禁用(t);const y=e.getIs高级键改键(t);if(e.getIsSwapKey(t),_){const{RT:s}=_;if(s||y){Object.values(p).forEach(n=>n.id[t].style.display="none");return}}let u=d.isHover,o=d.isSelected;o&&(e.当前选中按键_单键=t,e.当前选中按键_多键.includes(t)||e.当前选中按键_多键.push(t));const i=s=>{if(!s)return;const n=K.磁轴.所有按键.find(r=>r.按键===t);if(!n)return;const x=n?.轴体||"高特",b=s.querySelectorAll("path")[0];b&&(e.shouldSwitchBeDisplayed?b.setAttribute("fill",q(e.轴体颜色字典[x]||16771625)):b.style.display="none");const w=e.supportedSwitchTypes.findIndex(r=>r===x),h=s.querySelectorAll("text")[1];if(h&&(e.shouldSwitchBeDisplayed?a.setText(h,String(w+1)):h.style.display="none"),n&&n.行程设置.type==="行程设置"){let r=n.行程设置.行程按下,I=n.行程设置.行程抬起,c=s.querySelectorAll("text")[2],S=s.querySelectorAll("text")[3];c&&a.setText(c,r?.toFixed(e.travelPrecision)??"0.01"),S&&a.setText(S,I?.toFixed(e.travelPrecision)??"0.01")}};Object.values(p).forEach(s=>s.id[t].style.display="none"),!o&&!u?(a.show(p.default.id[t]),i(p.default.id[t])):!o&&u?(a.show(p.hover.id[t]),i(p.hover.id[t])):o&&!u?(a.show(p.current.id[t]),i(p.current.id[t])):o&&u&&(a.show(p.current_hover.id[t]),i(p.current_hover.id[t]))}),T.updateKeyboard(m,t=>{const d=E[t];if(!d)return;if(e.current键盘设置页SubpageIndex!==j.磁轴设置){Object.values(f).forEach(i=>i.id[t].style.display="none");return}const _=e.getCurrentDevice().磁轴.所有按键.find(i=>i.按键===t);if(_){const{RT:i}=_;e.getIs改键(t),e.getIs禁用(t);const s=e.getIs高级键改键(t);if(e.getIsSwapKey(t),!i||s){Object.values(f).forEach(n=>n.id[t].style.display="none");return}}let y=d.isHover,u=d.isSelected;u&&(e.当前选中按键_单键=t,e.当前选中按键_多键.includes(t)||e.当前选中按键_多键.push(t));const o=i=>{if(!i)return;const s=K.磁轴.所有按键.find(h=>h.按键===t);if(!s)return;const n=s?.轴体||"高特",x=i.querySelectorAll("path")[0];x&&(e.shouldSwitchBeDisplayed?x.setAttribute("fill",q(e.轴体颜色字典[n]||16771625)):x.style.display="none");const b=e.supportedSwitchTypes.findIndex(h=>h===n),w=i.querySelectorAll("text")[1];if(w&&(e.shouldSwitchBeDisplayed?a.setText(w,String(b+1)):w.style.display="none"),s&&s.行程设置.type==="行程设置"){let h=s.行程设置.行程按下,r=s.rt抬起,I=s.rt按下,c=i.querySelectorAll("text")[2],S=i.querySelectorAll("text")[3],A=i.querySelectorAll("text")[4];c&&a.setText(c,h.toFixed(e.travelPrecision)),S&&a.setText(S,I?.toFixed(e.travelPrecision)??"0.01"),A&&a.setText(A,r?.toFixed(e.travelPrecision)??"0.01")}};Object.values(f).forEach(i=>i.id[t].style.display="none"),!u&&!y?(a.show(f.default.id[t]),o(f.default.id[t])):!u&&y?(a.show(f.hover.id[t]),o(f.hover.id[t])):u&&!y?(a.show(f.current.id[t]),o(f.current.id[t])):u&&y&&(a.show(f.current_hover.id[t]),o(f.current_hover.id[t]))})}}),z.jsx(J,{divRef:V})};export{$ as Keyboard_81_MK830_KeyMappings_RT};
