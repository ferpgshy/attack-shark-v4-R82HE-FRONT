import{a8 as I,u as B,a as m,r as x,c as f,aq as y,j as c,V as p,B as F,y as w,d as O,G as A,ax as V,ay as q,ao as T,ap as H,az as b,a9 as M}from"./index.b078bf5f.js";import{u as R}from"./3ce44458.js";const z={colorPicker:{type:"svg",str:await I(()=>import("./232df906.js"),[],import.meta.url).then(s=>s.default),id:{hover:{fill:"g"},default:{fill:"g"},press:{fill:"g"}}}},W=({disabled:s=!1,currentLightData:o,type:_="light",title:l})=>{B();const n=m(),v=x.useRef(null),d=f.getCurrentDevice(),h=_==="sideLight"?d.sideLight:d.light,e=h.data[h.lightType],t=d.其他设置.省电模式是否开启,[C,u]=x.useState(y(o.color_value));x.useEffect(()=>{u(y(o.color_value))},[o.color_value]);const j=a=>{const r=S(a.replace("#","")),i=r>240;return{backgroundColor:a,color:r>128?"#000000":"#FFFFFF",...i&&{border:"1px solid rgba(0, 0, 0, 0.2)",boxShadow:"0 0 0 1px rgba(0, 0, 0, 0.1)"}}},S=a=>{const r=a.replace("#",""),i=parseInt(r.substr(0,2),16),g=parseInt(r.substr(2,2),16),k=parseInt(r.substr(4,2),16);return .299*i+.587*g+.114*k},E=l??"左右___主轴居中";return c.jsx(p,{type:E,w:"full",style:{gap:"40px",flexWrap:"wrap",opacity:s?.5:1,pointerEvents:s?"none":"auto",cursor:s?"not-allowed":"auto"},children:[n.炫彩,n.自定义色彩].map((a,r)=>{const i=r===1;return c.jsxs(p,{children:[c.jsx(F,{disabled:_!="sideLight"&&f.getCurrentDevice().light.lightType==="LightUserPicture"||e?.has_color===!1||t,text:a,w:130,h:44,isCurrent:r===0?o.color_type==="炫彩":o.color_type==="单色",style:e?.has_color&&i&&o.color_type==="单色"?j(C):void 0,onClick:()=>{if(t){w.error(n.省电模式下无法设置灯效||"省电模式下无法设置灯效",f.toastOptions);return}i?(o.color_type="单色",e?.has_color&&R.openColorPicker({div:v.current,value:y(o.color_value),onChange:g=>{o.color_value=g;const k=O.keyboardState.keys;Object.entries(k).forEach(([D,P])=>{P.isSelected&&(P.keyColor=g)})},position:{top:l!=null?"-25px":"25px",left:l!=null?"45px":"-175px"}})):o.color_type="炫彩"}}),c.jsx(p,{divRef:v,w:0,h:0})]},r)})})},J=s=>{const o=A(),_=V(o),l=q(o),n=x.useRef(null),v=m(),h=f.getCurrentDevice().其他设置.省电模式是否开启;return T({ref:o,onInit:e=>{const t=H(z).colorPicker(e);return t.root.querySelectorAll("rect").forEach(u=>{u.style.fill=b(s.color,1)}),t},onRefresh:e=>{e.hideAll();let t=e.status.default;e.root.querySelectorAll("rect").forEach(u=>{u.style.fill=b(s.color,1)}),_&&(t=e.status.hover),l&&(t=e.status.press),M.show(t.root)}}),c.jsxs(p,{style:{borderRadius:"6px",boxShadow:"0px 0px 2px rgba(0, 0, 0, 0.5)"},children:[c.jsx(p,{divRef:o,onClick:()=>{if(h){w.error(v.省电模式下无法设置灯效||"省电模式下无法设置灯效",f.toastOptions);return}s.onClick(),R.openColorPicker({div:n.current,value:y(s.color),onChange:e=>{s.onChange(e)},position:{top:"25px",left:"-175px"}})}}),c.jsx(p,{divRef:n,w:0,h:0})]})};export{J as C,W as a};
